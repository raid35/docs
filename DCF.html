<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SIKSA tv</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.1/shaka-player.compiled.js"></script>
    <script src="//content.jwplatform.com/libraries/SAHhwvZq.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>

    <script>
        jwplayer.key = "ITWMv7t88JGzI0xPwW8I0+LveiXX9SWbfdmt0ArUSyc=";

        $(document).ready(function() {

            // ضع رابط البث و مفتاح DRM هنا
            const streamUrl = "https://sps1.starzplayarabia.com/out/v1/41ff8fde1cd84ed5b30ab8198755356b/index.mpd"; // رابط البث
            const drmKeyId = "097963d6ad73c3d712a104981de0ed42";      // Key ID
            const drmKeyValue = "7b79353d7b840390d988d1bd6999302d";   // Key Value

            const channelData = {
                stream_url: streamUrl,
                drm_keys: {
                    [drmKeyId]: drmKeyValue
                }
            };

            if (channelData.stream_url) {
                setupJWPlayer(channelData);
            } else {
                alert("أدخل رابط البث والمفاتيح!");
            }
        });

        function setupJWPlayer(data) {
            const player = jwplayer("container").setup({
                width: "100%",
                height: "100%",
                controls: true,
                stretching: "uniform",
                horizontalVolumeSlider: true,
                autostart: true, // تشغيل تلقائي
                preload: "auto",
                playbackRateControls: true,
                mute: false, // الصوت مفعّل
                volume: 100, // الصوت على أعلى مستوى
                logo: {
                    file: "",
                    link: "SIKSA TV",
                    hide: false,
                    position: "bottom-left",
                    margin: 20
                },
                skin: {
                    url: "https://cdn.jsdelivr.net/gh/kiprox/cf-gdplay@master/skins/netplex.css",
                    name: "Netflix"
                },
                aspectratio: "16:9",
                vpaid: true,
                captions: {
                    color: "#f3f368",
                    fontSize: 16,
                    backgroundOpacity: 0,
                    fontFamily: "Helvetica",
                    edgeStyle: "raised"
                },
                playlist: [{
                    sources: [{
                        file: data.stream_url,
                        type: "dash",
                        drm: {
                            clearkey: {
                                keyId: Object.keys(data.drm_keys)[0],
                                key: Object.values(data.drm_keys)[0]
                            }
                        },
                        label: "HD"
                    }]
                }]
            });

            // معالجة قيود الصوت في التشغيل التلقائي
            player.on("ready", function() {
                player.setMute(false);
                player.setVolume(100);

                player.play().catch(function() {
                    console.warn("المتصفح منع التشغيل بالصوت، محاولة تشغيل مكتوم أولاً...");
                    player.setMute(true);
                    player.play().then(function() {
                        setTimeout(function() {
                            player.setMute(false);
                            player.setVolume(100);
                            console.log("تم تفعيل الصوت بعد بدء التشغيل ✅");
                        }, 1000);
                    });
                });

                console.log("تم تحميل المشغل ✅");
            });
        }
    </script>

    <style>
        * { margin: 0; padding: 0; outline: none; }
        #container { position: absolute; width: 100%!important; height: 100%!important; }
        *:focus { outline: none; }
    </style>
</head>

<body>
    <div id="container"></div>
</body>
</html>
