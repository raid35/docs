<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <title>Ù…Ø´ØºÙ„ ÙÙŠØ¯ÙŠÙˆ Ù…Ø¹ Ù‚Ù†ÙˆØ§Øª</title>
    <style>
      body,
      html {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: black;
      }
      .video-container {
        display: none; /* Ø£Ø®ÙÙŠÙ†Ø§ Ø§Ù„Ø­Ø§ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
      }
      #videoPlayer {
        width: 100%;
        height: 100%;
        background: black;
        object-fit: cover;
      }
      #controls {
        position: absolute;
        bottom: 0;
        width: 100%;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 10px;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
      }
      .controls.show {
        opacity: 1;
      }
      .btn {
        color: white;
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
      }
      .channel-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        grid-gap: 10px;
        padding: 20px;
      }
      .channel {
        background: #333;
        color: white;
        text-align: center;
        padding: 20px;
        cursor: pointer;
        border-radius: 8px;
        transition: background 0.3s;
      }
      .channel:hover {
        background: #444;
      }
      #loadingSpinner {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 60px;
        height: 60px;
        margin: -30px 0 0 -30px;
        border: 8px solid #00ff00;
        border-top: 8px solid transparent;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        z-index: 10000;
        display: none;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.6/shaka-player.compiled.min.js"></script>
  </head>
  <body>
    <div id="loadingSpinner"></div>

    <!-- Ù…Ø´ØºÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ -->
    <div id="videoContainer" class="video-container">
      <video id="videoPlayer" autoplay playsinline controls crossorigin="anonymous"></video>
      <div id="controls" class="controls">
        <button id="playPause" class="btn">â¯ï¸</button>
        <button id="mute" class="btn">ğŸ”‡</button>
        <input type="range" id="volumeControl" min="0" max="1" step="0.1" value="1" />
      </div>
    </div>

    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª -->
    <div id="channelList">
      <div class="channel-grid" id="channels">
        <!-- Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø³ØªØ¶Ø§Ù Ù‡Ù†Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… JavaScript -->
      </div>
    </div>

    <script>
      const channels = [
        {
          name: "SSC News",
          logo: "https://iili.io/JhkLNe9.png",
          url: "https://ssc-news-live-enc.edgenextcdn.net/out/v1/ef466f43623c4bbaa3f905b566ec35ea/index.mpd",
          drm: {
            clearkey: {
              keys: [
                {
                  kty: "oct",
                  kid: "3d04975236a44f62857d181597705ee6",
                  k: "362133e9cb13189ad4fe095ced216f60",
                },
              ],
            },
          },
        },
        {
          name: "SSC 1",
          logo: "https://iili.io/JhkQEp1.png",
          url: "https://ssc-1-enc.edgenextcdn.net/out/v1/c696e4819b55414388a1a487e8a45ca1/index.mpd",
          drm: {
            clearkey: {
              keys: [
                {
                  kty: "oct",
                  kid: "d84c325f36814f39bbe59080272b10c3",
                  k: "550727de4c96ef1ecff874905493580f",
                },
              ],
            },
          },
        },
        {
          name: "SSC 2",
          logo: "https://iili.io/JhkQMTF.png",
          url: "https://ssc-2-enc.edgenextcdn.net/out/v1/a16db2ec338a445a82d9c541cc9293f9/index.mpd",
          drm: {
            clearkey: {
              keys: [
                {
                  kty: "oct",
                  kid: "8bcfc55359e24bd7ad1c5560a96ddd3c",
                  k: "b5dcf721ab522af92a9d3bf0bd55b596",
                },
              ],
            },
          },
        },
        {
          name: "SSC 3",
          logo: "https://iili.io/JhkQVhg.png",
          url: "https://ssc-3-enc.edgenextcdn.net/out/v1/42e86125555242aaa2a12056832e7814/index.mpd",
          drm: {
            clearkey: {
              keys: [
                {
                  kty: "oct",
                  kid: "7de5dd08ad8041d586c2f16ccc9490a1",
                  k: "5e1503f3398b34f5099933fedab847ef",
                },
              ],
            },
          },
        },
      ];

      const videoPlayer = document.getElementById("videoPlayer");
      const videoContainer = document.getElementById("videoContainer");
      const channelList = document.getElementById("channels");
      const loadingSpinner = document.getElementById("loadingSpinner");
      const controls = document.getElementById("controls");
      const playPause = document.getElementById("playPause");
      const mute = document.getElementById("mute");
      const volumeControl = document.getElementById("volumeControl");

      const player = new shaka.Player(videoPlayer);

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù€ DRM
      player.configure({
        drm: {
          clearKeys: channels.reduce((map, channel) => {
            map[channel.drm.clearkey.keys[0].kid] = channel.drm.clearkey.keys[0].k;
            return map;
          }, {}),
        },
      });

      function initPlayer(channel) {
        // Ø¥Ø®ÙØ§Ø¡ ØµÙØ­Ø© Ø§Ù„Ù‚Ù†ÙˆØ§Øª
        channelList.style.display = "none";
        videoContainer.style.display = "block";
        loadingSpinner.style.display = "block";

        player
          .load(channel.url)
          .then(() => {
            loadingSpinner.style.display = "none";
            console.log("âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ù†Ø¬Ø§Ø­!");
            videoPlayer.play();
          })
          .catch((e) => {
            console.error("âŒ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ù†Ø§Ø©:", e);
            loadingSpinner.style.display = "none";
          });
      }

      // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
      channels.forEach((channel) => {
        const channelDiv = document.createElement("div");
        channelDiv.classList.add("channel");
        channelDiv.innerHTML = `
          <img src="${channel.logo}" alt="${channel.name}" style="width: 100px; height: 100px; margin-bottom: 10px;">
          <div>${channel.name}</div>
        `;
        channelDiv.addEventListener("click", () => initPlayer(channel));
        channelList.appendChild(channelDiv);
      });

      // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ù„Ù„ØªØ­ÙƒÙ…
      playPause.addEventListener("click", () => {
        if (videoPlayer.paused) {
          videoPlayer.play();
        } else {
          videoPlayer.pause();
        }
      });

      mute.addEventListener("click", () => {
        videoPlayer.muted = !videoPlayer.muted;
      });

      volumeControl.addEventListener("input", (event) => {
        videoPlayer.volume = event.target.value;
      });

      // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚Ù†ÙˆØ§Øª
      window.addEventListener("keydown", (e) => {
        if (e.key === "Backspace" || e.key === "Escape") {
          videoContainer.style.display = "none";
          channelList.style.display = "block";
          player.unload();
        }
      });
    </script>
  </body>
</html>
