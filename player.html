<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Siksa TV Pro</title>
    <meta name="referrer" content="no-referrer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://ssl.p.jwpcdn.com/player/v/8.26.0/jwplayer.js"></script>
    <script>jwplayer.key = "XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo";</script>

    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: black; overflow: hidden; }
        #jwplayerDiv { width: 100% !important; height: 100% !important; }
        /* إخفاء رسائل الخطأ المزعجة التي قد تظهر فوق الفيديو */
        .jw-error-msg { display: none !important; }
    </style>
</head>
<body>

    <div id="jwplayerDiv"></div>

    <script>
        // 1. نظام تزوير الهوية (User-Agent) لتخطي الحماية
        (function() {
            var customUA = "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36";
            var XHROpen = XMLHttpRequest.prototype.open;
            XMLHttpRequest.prototype.open = function() {
                this.addEventListener('loadstart', function() {
                    this.setRequestHeader('User-Agent', customUA);
                });
                return XHROpen.apply(this, arguments);
            };
        })();

        // 2. قائمة القنوات مع تصحيح الروابط والمفاتيح
        const channelList = {
            "BEIN1": {
                url: "https://aba5sdmaaaaaaaamooyrewxky2c4j.otte.live.cf.ww.aiv-cdn.net/syd-nitro/live/dash/enc/ghwcl6hv68/out/v1/83536910d8034e9b9895a20fbe1c1687/cenc.mpd",
                kid: "335dad778109954503dcbb21dc92015f", 
                key: "24bfd75d436cbf73168a2a2dccd40281"
            },
            "BEIN2": {
                url: "https://aba5sdmaaaaaaaamdwujas5g6mg4r.otte.live.cf.ww.aiv-cdn.net/syd-nitro/live/clients/dash/enc/8m8cd46i1t/out/v1/83985c68e4174e90a58a1f2c024be4c9/cenc.mpd",
                kid: "0b42be2664d7e811d04f3e504e0924c5", 
                key: "ae24090123b8c72ac5404dc152847cb8"
            },
            "BEIN3": {
                url: "https://aba5sdmaaaaaaaamhq2w5oosrf5ae.otte.live.cf.ww.aiv-cdn.net/syd-nitro/live/clients/dash/enc/q4u5nwaogz/out/v1/18de6d3e65934f3a8de4358e69eab86c/cenc.mpd",
                kid: "7995c724a13748ed970840a8ab5bb9b3", 
                key: "67bdaf1e2175b9ff682fcdf0e2354b1e"
            }
        };

        const urlParams = new URLSearchParams(window.location.search);
        const getID = urlParams.get('id') || "BEIN1";
        const ch = channelList[getID] || channelList["BEIN1"];

        // 3. إعداد المشغل (تأكد من أن أسماء المفاتيح داخل clearkey دقيقة)
        const player = jwplayer("jwplayerDiv").setup({
            playlist: [{
                file: ch.url,
                drm: {
                    clearkey: {
                        keyId: ch.kid,
                        key: ch.key
                    }
                }
            }],
            width: "100%",
            height: "100%",
            autostart: true,
            stretching: "fill",
            displaytitle: false,
            cast: {} // لدعم الكروم كاست
        });

        // اختيار اللغة العربية تلقائياً
        player.on('audioTracks', function(e) {
            e.tracks.forEach((track, index) => {
                if (track.label.toLowerCase().includes("ar")) {
                    player.setCurrentAudioTrack(index);
                }
            });
        });

        // التعامل مع الخطأ (إعادة تشغيل تلقائي في حال فشل السيرفر)
        player.on('error', function() {
            setTimeout(function() {
                player.load();
                player.play();
            }, 2000);
        });

    </script>
</body>
</html>
