<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>Smart TV Player Pro</title>
    <meta name="referrer" content="no-referrer" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="//ssl.p.jwpcdn.com/player/v/8.26.0/jwplayer.js"></script>
    <script>jwplayer.key = "XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo";</script>
    <link rel="stylesheet" href="https://akomov.com/todapi/jw_ako.css">

    <style>
        body, html { margin: 0; padding: 0; width: 100%; height: 100%; background-color: black; overflow: hidden; }
        #jwplayerDiv { width: 100% !important; height: 100% !important; }
    </style>
</head>
<body>

    <div id="jwplayerDiv"></div>

    <script>
        // 1. تزوير الهوية (ضروري فقط لتشغيل الروابط)
        (function() {
            var originalFetch = window.fetch;
            var originalXHR = window.XMLHttpRequest;
            var customUA = "Mozilla/5.0 (Smart-TV; Linux; Tizen 6.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 TV Safari/537.36";
            window.fetch = function(url, options) {
                options = options || {};
                options.headers = options.headers || {};
                options.headers['User-Agent'] = customUA;
                return originalFetch.call(this, url, options);
            };
            var XHROpen = originalXHR.prototype.open;
            originalXHR.prototype.open = function(method, url) {
                XHROpen.apply(this, arguments);
                this.setRequestHeader('User-Agent', customUA);
            };
        })();

        // أيقونة التمدد
        const expandSvg = `<svg fill="#ffffff" version="1.1" id="expand_icon" xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" viewBox="0 0 100 100"><g><path d="M22.661,20.5H36c1.104,0,2-0.896,2-2s-0.896-2-2-2H19c-1.104,0-2.5,1.276-2.5,2.381v17c0,1.104,0.896,2,2,2s2-0.896,2-2V24.876l16.042,15.791c0.391,0.391,1.027,0.586,1.539,0.586s1.086-0.195,1.477-0.586c0.781-0.781,0.812-2.237,0.031-3.019L22.661,20.5z"/><path d="M83,16.5H66c-1.104,0-2,0.896-2,2s0.896,2,2,2h12.605L61.647,37.648c-0.781,0.781-0.781,2.142,0,2.923c0.39,0.391,0.902,0.633,1.414,0.633s0.774-0.171,1.164-0.562l16.274-16.5v11.738c0,1.104,0.896,2,2,2s2-0.896,2-2v-17C84.5,17.776,84.104,16.5,83,16.5z"/><path d="M36.542,60.962L20.5,76.754V65.881c0-1.104-0.896-2-2-2s-2,0.896-2,2v17c0,1.104,1.396,1.619,2.5,1.619h17c1.104,0,2-0.896,2-2s-0.896-2-2-2H22.529L39.62,63.6c0.781-0.781,0.656-1.951-0.125-2.732C38.715,60.086,37.322,60.181,36.542,60.962z"/><path d="M82.5,63.881c-1.104,0-2,0.896-2,2v11.606L64.226,60.962c-0.78-0.781-1.923-0.781-2.703,0c-0.781,0.781-0.719,1.856,0.062,2.638l17.152,16.9H66c-1.104,0-2,0.896-2,2s0.896,2,2,2h17c1.104,0,1.5-0.515,1.5-1.619v-17C84.5,64.776,83.604,63.881,82.5,63.881z"/></g></svg>`;

        const channelList = {
            "BEIN2": {
                url: "https://aba5sdmaaaaaaaamdwujas5g6mg4r.otte.live.cf.ww.aiv-cdn.net/syd-nitro/live/clients/dash/enc/8m8cd46i1t/out/v1/83985c68e4174e90a58a1f2c024be4c9/cenc.mpd",
                k1: "0b42be2664d7e811d04f3e504e0924c5",
                k2: "ae24090123b8c72ac5404dc152847cb8"
            },
            "BEIN3": {
                url: "https://aba5sdmaaaaaaaamhq2w5oosrf5ae.otte.live.cf.ww.aiv-cdn.net/syd-nitro/live/clients/dash/enc/q4u5nwaogz/out/v1/18de6d3e65934f3a8de4358e69eab86c/cenc.mpd",
                k1: "7995c724a13748ed970840a8ab5bb9b3",
                k2: "67bdaf1e2175b9ff682fcdf0e2354b1e"
                 },
            "sps1": {
                url: "https://sps1.starzplayarabia.com/out/v1/eee188845e9543699fd24e5a9890c6e2/index.mpd",
                k1: "b253c726c24c7c94a3ddf9b1907e2c76",
                k2: "097963d6ad73c3d712a104981de0ed42"
                 },
            "sps2": {
                url: "https://sps2.starzplayarabia.com/out/v1/15e7d1ffb99746dda03f71dbbbc3c08b/index.mpd",
                k1: "ee861edcd99093153a763a94b14c2c5a",
                k2: "ab3991f6a7729ba1ea4bcdba0c1ae6c0"
                "shahid-sports-1": {
                url: "https://shahid-sports-1-enc.edgenextcdn.net/out/v1/0169cfa282614ebe97ef0201da87bb04/index.mpd",
                k1: "ab081a704aad41829b1123b09b6ecafd",
                k2: "dd51609092fff15e68b91debf5d591f9"
                 },
            "La_Une": {
                url: "https://c9851ec-rbm-hilv-fsly.cdn.redbee.live/L26/669bb376/9069a322.isml/.mpd",
                k1: "cbdd636bb2e44f1fa6ebd41f46a3cc52",
                k2: "e6ab6c56a79962dcab612e9dc4fea986"
                 },
            "LA_LIGÁ": {
                url: "https://ottb.live.cf.ww.aiv-cdn.net/dub-nitro/live/clients/dash/enc/k0duzgfejg/out/v1/70a50b1bda944628b8e7e66ab4069419/cenc.mpd",
                k1: "620e51b82596475517a27aa425c52280",
                k2: "2b9ba811e9c5aeafc8ae1b71cdca4d6a"
                 },
            "sky_football": {
                url: "https://abe4mdzaaaaaaaampzanwc57oxzti.otte.live.cf.ww.aiv-cdn.net/lhr-nitro/live/clients/dash/enc/9o6jmlyjpm/out/v1/ad80a9bfecc6438f82f2af41c58d7fb8/cenc.mpd",
                k1: "ef34ae91b4f2415e8439b2ad105e7488",
                k2: "243248d8de1ff8c7c587ee2057317523"
                 },
            "Матч!_1": {
                url: "https://video.beeline.tv/live/d/channel319.isml/manifest-stb.mpd",
                k1: "9145a6e0f778e61866f573d4944dd533",
                k2: "d02173d40515fea5c83944f21d0f3114"
                 },
            "Матч!_2": {
                url: "https://video.beeline.tv/live/d/channel320.isml/manifest-stb.mpd",
                k1: "ce7cf9b28d1a8d874accebc44d7e1fcd",
                k2: "cda18d4d20abd5cc778315abe277feb9"
                 },
            "Матч!_3": {
                url: "https://video.beeline.tv/live/d/channel321.isml/manifest-stb.mpd",
                k1: "6cfb55b12aaa9df1626a8adaa4f26329",
                k2: "84486e2e8e5fdee2ef8240019923078c"
                 },
            "Sport_1SK": {
                url: "https://video.beeline.tv/live/d/channel319.isml/manifest-stb.mpd",
                k1: "11223344556677889900112233445566",
                k2: "cda18d4d20abd5cc778315abe277feb9"
                 },
            "Sport_2SK": {
                url: "https://dash2.antik.sk/stream/nvidia_sport_1/playlist_cenc.mpd",
                k1: "11223344556677889900112233445566",
                k2: "4b80724d0ef86bcb2c21f7999d67739d"
                 },
            "Матч!_1": {
                url: "https://video.beeline.tv/live/d/channel319.isml/manifest-stb.mpd",
                k1: "ce7cf9b28d1a8d874accebc44d7e1fcd",
                k2: "cda18d4d20abd5cc778315abe277feb9"
                 },
            "Матч!_1": {
                url: "https://video.beeline.tv/live/d/channel319.isml/manifest-stb.mpd",
                k1: "ce7cf9b28d1a8d874accebc44d7e1fcd",
                k2: "cda18d4d20abd5cc778315abe277feb9"
                 },
            "Матч!_1": {
                url: "https://video.beeline.tv/live/d/channel319.isml/manifest-stb.mpd",
                k1: "ce7cf9b28d1a8d874accebc44d7e1fcd",
                k2: "cda18d4d20abd5cc778315abe277feb9"
                 },
            "Матч!_1": {
                url: "https://video.beeline.tv/live/d/channel319.isml/manifest-stb.mpd",
                k1: "ce7cf9b28d1a8d874accebc44d7e1fcd",
                k2: "cda18d4d20abd5cc778315abe277feb9"
                 },
            "Матч!_1": {
                url: "https://video.beeline.tv/live/d/channel319.isml/manifest-stb.mpd",
                k1: "ce7cf9b28d1a8d874accebc44d7e1fcd",
                k2: "cda18d4d20abd5cc778315abe277feb9"
            }
        };

        const urlParams = new URLSearchParams(window.location.search);
        const getID = urlParams.get('id') || "SSC1";
        let isExpanded = true;

        const player = jwplayer("jwplayerDiv").setup({
            file: channelList[getID]?.url || channelList["SSC1"].url,
            width: "100%",
            height: "100%",
            autostart: true,
            stretching: "fill",
            drm: { 
                clearkey: { 
                    keyId: channelList[getID]?.k1 || channelList["SSC1"].k1, 
                    key: channelList[getID]?.k2 || channelList["SSC1"].k2 
                } 
            }
        });

        player.on('ready', function() {
            player.addButton(expandSvg, 'تمدد الفيديو', function() {
                isExpanded = !isExpanded;
                const video = document.querySelector("#jwplayerDiv video");
                if (video) video.style.objectFit = isExpanded ? 'fill' : 'contain';
            }, 'expandButton');
        });

        // اختيار الصوت العربي تلقائياً
        player.on('audioTracks', function() {
            const tracks = player.getAudioTracks();
            tracks.forEach((track, index) => {
                if (track.label.toLowerCase().includes("ara") || track.label.includes("عربي")) {
                    player.setCurrentAudioTrack(index);
                }
            });
        });

        // الحل النهائي لمشكلة الصوت في الخلفية: إيقاف المشغل تماماً عند الخروج أو إخفاء الصفحة
        window.addEventListener("beforeunload", function() { player.remove(); });
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) { 
                player.pause(); 
                window.location.reload(); // إعادة تحميل لضمان قطع البث تماماً
            }
        });

    </script>
</body>
</html>
